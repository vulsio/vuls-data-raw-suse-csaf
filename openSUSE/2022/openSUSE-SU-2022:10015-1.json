{
	"document": {
		"aggregate_severity": {
			"namespace": "https://www.suse.com/support/security/rating/",
			"text": "important"
		},
		"category": "csaf_security_advisory",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright 2024 SUSE LLC. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "Security update for firejail",
				"title": "Title of the patch"
			},
			{
				"category": "description",
				"text": "This update for firejail fixes the following issues:\n\nfirejail was updated to version 0.9.70:\n\n-CVE-2022-31214: - root escalation in --join logic (boo#1199148)\n Reported by Matthias Gerstner, working exploit code was provided to our\n development team. In the same time frame, the problem was independently\n reported by Birk Blechschmidt. Full working exploit code was also provided.\n\n- feature: enable shell tab completion with --tab (#4936)\n- feature: disable user profiles at compile time (#4990)\n- feature: Allow resolution of .local names with avahi-daemon in the apparmor\n- profile (#5088)\n- feature: always log seccomp errors (#5110)\n- feature: firecfg --guide, guided user configuration (#5111)\n- feature: --oom, kernel OutOfMemory-killer (#5122)\n- modif: --ids feature needs to be enabled at compile time (#5155)\n- modif: --nettrace only available to root user\n- rework: whitelist restructuring (#4985)\n- rework: firemon, speed up and lots of fixes\n- bugfix: --private-cwd not expanding macros, broken hyperrogue (#4910)\n- bugfix: nogroups + wrc prints confusing messages (#4930 #4933)\n- bugfix: openSUSE Leap - whitelist-run-common.inc (#4954)\n- bugfix: fix printing in evince (#5011)\n- bugfix: gcov: fix gcov functions always declared as dummy (#5028)\n- bugfix: Stop warning on safe supplementary group clean (#5114)\n- build: remove ultimately unused INSTALL and RANLIB check macros (#5133)\n- build: mkdeb.sh.in: pass remaining arguments to ./configure (#5154)\n- ci: replace centos (EOL) with almalinux (#4912)\n- ci: fix --version not printing compile-time features (#5147)\n- ci: print version after install & fix apparmor support on build_apparmor (#5148)\n- docs: Refer to firejail.config in configuration files (#4916)\n- docs: firejail.config: add warning about allow-tray (#4946)\n- docs: mention that the protocol command accumulates (#5043)\n- docs: mention inconsistent homedir bug involving --private=dir (#5052)\n- docs: mention capabilities(7) on --caps (#5078)\n- new profiles: onionshare, onionshare-cli, opera-developer, songrec\n- new profiles: node-gyp, npx, semver, ping-hardened\n- removed profiles: nvm\n",
				"title": "Description of the patch"
			},
			{
				"category": "details",
				"text": "openSUSE-2022-10015",
				"title": "Patchnames"
			},
			{
				"category": "legal_disclaimer",
				"text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
				"title": "Terms of use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://www.suse.com/support/security/contact/",
			"name": "SUSE Product Security Team",
			"namespace": "https://www.suse.com/"
		},
		"references": [
			{
				"category": "external",
				"summary": "SUSE ratings",
				"url": "https://www.suse.com/support/security/rating/"
			},
			{
				"category": "self",
				"summary": "URL of this CSAF notice",
				"url": "https://ftp.suse.com/pub/projects/security/csaf/opensuse-su-2022_10015-1.json"
			},
			{
				"category": "self",
				"summary": "URL for openSUSE-SU-2022:10015-1",
				"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/Y44WP6HYFSMERMHYQLJJNHIWG34P4MU4/"
			},
			{
				"category": "self",
				"summary": "E-Mail link for openSUSE-SU-2022:10015-1",
				"url": "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/thread/Y44WP6HYFSMERMHYQLJJNHIWG34P4MU4/"
			},
			{
				"category": "self",
				"summary": "SUSE Bug 1199148",
				"url": "https://bugzilla.suse.com/1199148"
			},
			{
				"category": "self",
				"summary": "SUSE CVE CVE-2022-31214 page",
				"url": "https://www.suse.com/security/cve/CVE-2022-31214/"
			}
		],
		"title": "Security update for firejail",
		"tracking": {
			"current_release_date": "2022-06-20T07:21:57Z",
			"generator": {
				"date": "2022-06-20T07:21:57Z",
				"engine": {
					"name": "cve-database.git:bin/generate-csaf.pl",
					"version": "1"
				}
			},
			"id": "openSUSE-SU-2022:10015-1",
			"initial_release_date": "2022-06-20T07:21:57Z",
			"revision_history": [
				{
					"date": "2022-06-20T07:21:57Z",
					"number": "1",
					"summary": "Current version"
				}
			],
			"status": "final",
			"version": "1"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_version",
								"name": "firejail-0.9.70-bp153.2.6.1.aarch64",
								"product": {
									"name": "firejail-0.9.70-bp153.2.6.1.aarch64",
									"product_id": "firejail-0.9.70-bp153.2.6.1.aarch64"
								}
							}
						],
						"category": "architecture",
						"name": "aarch64"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "firejail-0.9.70-bp153.2.6.1.i586",
								"product": {
									"name": "firejail-0.9.70-bp153.2.6.1.i586",
									"product_id": "firejail-0.9.70-bp153.2.6.1.i586"
								}
							}
						],
						"category": "architecture",
						"name": "i586"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "firejail-0.9.70-bp153.2.6.1.ppc64le",
								"product": {
									"name": "firejail-0.9.70-bp153.2.6.1.ppc64le",
									"product_id": "firejail-0.9.70-bp153.2.6.1.ppc64le"
								}
							}
						],
						"category": "architecture",
						"name": "ppc64le"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "firejail-0.9.70-bp153.2.6.1.s390x",
								"product": {
									"name": "firejail-0.9.70-bp153.2.6.1.s390x",
									"product_id": "firejail-0.9.70-bp153.2.6.1.s390x"
								}
							}
						],
						"category": "architecture",
						"name": "s390x"
					},
					{
						"branches": [
							{
								"category": "product_version",
								"name": "firejail-0.9.70-bp153.2.6.1.x86_64",
								"product": {
									"name": "firejail-0.9.70-bp153.2.6.1.x86_64",
									"product_id": "firejail-0.9.70-bp153.2.6.1.x86_64"
								}
							}
						],
						"category": "architecture",
						"name": "x86_64"
					},
					{
						"branches": [
							{
								"category": "product_name",
								"name": "SUSE Package Hub 15 SP3",
								"product": {
									"name": "SUSE Package Hub 15 SP3",
									"product_id": "SUSE Package Hub 15 SP3"
								}
							},
							{
								"category": "product_name",
								"name": "openSUSE Leap 15.3",
								"product": {
									"name": "openSUSE Leap 15.3",
									"product_id": "openSUSE Leap 15.3",
									"product_identification_helper": {
										"cpe": "cpe:/o:opensuse:leap:15.3"
									}
								}
							}
						],
						"category": "product_family",
						"name": "SUSE Linux Enterprise"
					}
				],
				"category": "vendor",
				"name": "SUSE"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.aarch64 as component of SUSE Package Hub 15 SP3",
					"product_id": "SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.aarch64"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.aarch64",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.i586 as component of SUSE Package Hub 15 SP3",
					"product_id": "SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.i586"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.i586",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.ppc64le as component of SUSE Package Hub 15 SP3",
					"product_id": "SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.ppc64le"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.ppc64le",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.s390x as component of SUSE Package Hub 15 SP3",
					"product_id": "SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.s390x"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.s390x",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.x86_64 as component of SUSE Package Hub 15 SP3",
					"product_id": "SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.x86_64"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.x86_64",
				"relates_to_product_reference": "SUSE Package Hub 15 SP3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.aarch64 as component of openSUSE Leap 15.3",
					"product_id": "openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.aarch64"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.aarch64",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.i586 as component of openSUSE Leap 15.3",
					"product_id": "openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.i586"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.i586",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.ppc64le as component of openSUSE Leap 15.3",
					"product_id": "openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.ppc64le"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.ppc64le",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.s390x as component of openSUSE Leap 15.3",
					"product_id": "openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.s390x"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.s390x",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "firejail-0.9.70-bp153.2.6.1.x86_64 as component of openSUSE Leap 15.3",
					"product_id": "openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.x86_64"
				},
				"product_reference": "firejail-0.9.70-bp153.2.6.1.x86_64",
				"relates_to_product_reference": "openSUSE Leap 15.3"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2022-31214",
			"ids": [
				{
					"system_name": "SUSE CVE Page",
					"text": "https://www.suse.com/security/cve/CVE-2022-31214"
				}
			],
			"notes": [
				{
					"category": "general",
					"text": "A Privilege Context Switching issue was discovered in join.c in Firejail 0.9.68. By crafting a bogus Firejail container that is accepted by the Firejail setuid-root program as a join target, a local attacker can enter an environment in which the Linux user namespace is still the initial user namespace, the NO_NEW_PRIVS prctl is not activated, and the entered mount namespace is under the attacker's control. In this way, the filesystem layout can be adjusted to gain root privileges through execution of available setuid-root binaries such as su or sudo.",
					"title": "CVE description"
				}
			],
			"product_status": {
				"fixed": [
					"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.aarch64",
					"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.i586",
					"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.ppc64le",
					"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.s390x",
					"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.x86_64",
					"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.aarch64",
					"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.i586",
					"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.ppc64le",
					"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.s390x",
					"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.x86_64"
				]
			},
			"references": [
				{
					"category": "external",
					"summary": "CVE-2022-31214",
					"url": "https://www.suse.com/security/cve/CVE-2022-31214"
				},
				{
					"category": "external",
					"summary": "SUSE Bug 1199148 for CVE-2022-31214",
					"url": "https://bugzilla.suse.com/1199148"
				}
			],
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
					"product_ids": [
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.aarch64",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.i586",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.ppc64le",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.s390x",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.x86_64",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.aarch64",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.i586",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.ppc64le",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.s390x",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.x86_64"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"baseScore": 7.8,
						"baseSeverity": "HIGH",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.aarch64",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.i586",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.ppc64le",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.s390x",
						"SUSE Package Hub 15 SP3:firejail-0.9.70-bp153.2.6.1.x86_64",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.aarch64",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.i586",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.ppc64le",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.s390x",
						"openSUSE Leap 15.3:firejail-0.9.70-bp153.2.6.1.x86_64"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"date": "2022-06-20T07:21:57Z",
					"details": "important"
				}
			],
			"title": "CVE-2022-31214"
		}
	]
}
